name: PR open

on:
  pull_request:
    types: [opened, reopened]

jobs:
  PR-open:
    runs-on: ubuntu-latest
    steps:
      - name: Add label to PR
        uses: actions/github-script@v7
        with:
          script: |
            await github.rest.issues.addLabels({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.issue.number,
              labels: ['check']
            })
      - name: Send to Discord
        run: |
          REPO_URL="${{ github.server_url }}/${{ github.repository }}"
          
          # –§–æ—Ä–º–∏—Ä—É–µ–º JSON –¥–ª—è Discord webhook
          curl -H "Content-Type: application/json" \
          -X POST \
          -d '{
            "username": "GitHub Bot",
            "avatar_url": "https://github.com/github.png",
            "embeds": [{
              "title": "üöÄ New Pull Request",
              "description": "**Author**: ${{ github.actor }}\n**${{ github.event.pull_request.title }}**\n${{ github.event.pull_request.body }}",
              "url": "'"$REPO_URL"'",
              "color": 3066993,
              "timestamp": "'"$(date -u +%Y-%m-%dT%H:%M:%SZ)"'"
            }]
          }' ${{ secrets.DISCORD_WEBHOOK_URL }}
